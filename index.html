<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="/image.jpeg">
    <title>NDMA - Capacity Building & Training Platform</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Main Application - Now shows by default -->
    <div id="mainApp" class="main-app">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="header-left">
                    <button id="sidebarToggle" class="sidebar-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="ndma-logo-small">
                        <i class="fas fa-shield-alt"></i>
                        <span>NDMA CBT</span>
                    </div>
                </div>
                <div class="header-right">
                    <!-- Guest State - Authentication Buttons -->
                    <div id="guestNavigation" class="guest-navigation">
                        <button id="signInBtn" class="btn btn--outline btn--sm auth-btn">
                            <i class="fas fa-user-plus"></i>
                            <span>Sign In</span>
                        </button>
                        <button id="logInBtn" class="btn btn--primary btn--sm auth-btn">
                            <i class="fas fa-sign-in-alt"></i>
                            <span>Log In</span>
                        </button>
                    </div>

                    <!-- Logged In State - User Profile -->
                    <div id="userNavigation" class="user-navigation hidden">
                        <button class="notification-btn">
                            <i class="fas fa-bell"></i>
                            <span class="notification-count">3</span>
                        </button>
                        <div class="user-profile">
                            <div id="userAvatar" class="user-avatar">G</div>
                            <div class="user-info">
                                <span id="userName">Guest User</span>
                                <small id="userRole">Public Access</small>
                            </div>
                            <button id="logoutBtn" class="logout-btn">
                                <i class="fas fa-sign-out-alt"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar">
            <nav class="sidebar-nav">
                <a href="#dashboard" class="nav-item active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#trainings" class="nav-item" data-section="trainings">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Training Events</span>
                </a>
                <a href="#map" class="nav-item" data-section="map">
                    <i class="fas fa-map"></i>
                    <span>GIS Mapping</span>
                </a>
                <a href="#attendance" class="nav-item restricted-access" data-section="attendance">
                    <i class="fas fa-qrcode"></i>
                    <span>Attendance</span>
                </a>
                <a href="#analytics" class="nav-item" data-section="analytics">
                    <i class="fas fa-chart-bar"></i>
                    <span>Analytics</span>
                </a>
                <a href="#alerts" class="nav-item restricted-access" data-section="alerts">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Alerts</span>
                </a>
                <a href="#reports" class="nav-item" data-section="reports">
                    <i class="fas fa-file-alt"></i>
                    <span>Reports</span>
                </a>
                <a href="#users" class="nav-item admin-only" data-section="users">
                    <i class="fas fa-users"></i>
                    <span>User Management</span>
                </a>
                <a href="#settings" class="nav-item admin-only" data-section="settings">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <div class="section-header">
                    <h1>Dashboard</h1>
                    <!-- <p>Overview of training activities and platform metrics</p> -->
                    <p>SafeStep - Your Path to Disaster Preparedness</p>
                </div>

                <div id="guestWelcome" class="guest-welcome">
                    <div class="welcome-card">
                        <div class="welcome-content">
                            <h2>Welcome to NDMA Capacity Building & Training Platform</h2>
                            <p>Access public training information, upcoming events, and general disaster management resources. Sign in to access personalized features and restricted content.</p>
                            <div class="welcome-actions">
                                <button class="btn btn--primary" onclick="document.getElementById('signInBtn').click()">
                                    <i class="fas fa-user-plus"></i>
                                    Create Account
                                </button>
                                <button class="btn btn--outline" onclick="document.getElementById('logInBtn').click()">
                                    <i class="fas fa-sign-in-alt"></i>
                                    Sign In to Account
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="metric-content">
                            <h3>156</h3>
                            <p>Total Trainings</p>
                            <small class="metric-trend positive">+12% from last month</small>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="metric-content">
                            <h3>4,200</h3>
                            <p>Total Participants</p>
                            <small class="metric-trend positive">+8% from last month</small>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-map-marked-alt"></i>
                        </div>
                        <div class="metric-content">
                            <h3>28</h3>
                            <p>States Covered</p>
                            <small class="metric-trend neutral">No change</small>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="metric-content">
                            <h3>4.3</h3>
                            <p>Avg. Rating</p>
                            <small class="metric-trend positive">+0.2 from last month</small>
                        </div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>Training Locations</h3>
                        <div id="dashboardMap" class="dashboard-map"></div>
                    </div>
                    
                    <div class="dashboard-card">
                        <h3>Recent Activities</h3>
                        <div class="activity-list">
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-plus-circle"></i>
                                </div>
                                <div class="activity-content">
                                    <p><strong>New training created:</strong> Disaster Response Training - Mumbai</p>
                                    <small>2 hours ago</small>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-user-check"></i>
                                </div>
                                <div class="activity-content">
                                    <p><strong>Attendance marked:</strong> 42 participants in Delhi workshop</p>
                                    <small>4 hours ago</small>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="activity-content">
                                    <p><strong>Feedback received:</strong> 4.5/5 rating for Chennai training</p>
                                    <small>1 day ago</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <h3>Quick Actions</h3>
                        <div class="quick-actions">
                            <button class="btn btn--primary" onclick="showSection('trainings')">
                                <i class="fas fa-calendar"></i>
                                View Trainings
                            </button>
                            <button class="btn btn--secondary" onclick="showSection('map')">
                                <i class="fas fa-map"></i>
                                Explore Map
                            </button>
                            <button class="btn btn--outline" onclick="showSection('reports')">
                                <i class="fas fa-download"></i>
                                Public Reports
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Training Events Section -->
            <section id="trainings" class="content-section">
                <div class="section-header">
                    <h1>Training Events</h1>
                    <button id="addTrainingBtn" class="btn btn--primary restricted-feature">
                        <i class="fas fa-plus"></i>
                        Add Training
                    </button>
                </div>

                <div class="filters-bar">
                    <div class="filters-group">
                        <select class="form-control filter-select">
                            <option value="">All States</option>
                            <option value="Delhi">Delhi</option>
                            <option value="Maharashtra">Maharashtra</option>
                            <option value="Karnataka">Karnataka</option>
                        </select>
                        <select class="form-control filter-select">
                            <option value="">All Themes</option>
                            <option value="Disaster Response">Disaster Response</option>
                            <option value="Risk Assessment">Risk Assessment</option>
                            <option value="Community Engagement">Community Engagement</option>
                        </select>
                        <input type="date" class="form-control filter-input">
                        <input type="search" class="form-control filter-input" placeholder="Search trainings...">
                    </div>
                </div>

                <div class="trainings-grid" id="trainingsGrid">
                    <!-- Training cards will be populated by JavaScript -->
                </div>
            </section>

            <!-- GIS Mapping Section -->
            <section id="map" class="content-section">
                <div class="section-header">
                    <h1>GIS Mapping</h1>
                    <div class="map-controls">
                        <button class="btn btn--secondary" id="exportMapBtn">
                            <i class="fas fa-download"></i>
                            Export Map
                        </button>
                    </div>
                </div>

                <div class="map-container">
                    <div class="map-sidebar">
                        <h3>Filters</h3>
                        <div class="filter-group">
                            <label>State</label>
                            <select id="mapStateFilter" class="form-control">
                                <option value="">All States</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Theme</label>
                            <select id="mapThemeFilter" class="form-control">
                                <option value="">All Themes</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Date Range</label>
                            <input type="date" id="mapStartDate" class="form-control">
                            <input type="date" id="mapEndDate" class="form-control">
                        </div>
                        <button class="btn btn--primary btn--full-width" id="applyMapFilters">Apply Filters</button>
                    </div>
                    <div id="mainMap" class="main-map"></div>
                </div>
            </section>

            <!-- Attendance Section - Restricted -->
            <section id="attendance" class="content-section">
                <div class="section-header">
                    <h1>Attendance Management</h1>
                </div>

                <div id="attendanceContent" class="attendance-content">
                    <!-- Content will be loaded based on authentication status -->
                </div>
            </section>

            <!-- Analytics Section -->
            <section id="analytics" class="content-section">
                <div class="section-header">
                    <h1>Analytics & Feedback</h1>
                </div>

                <div class="analytics-grid">
                    <div class="card">
                        <div class="card__body">
                            <h3>Training Effectiveness</h3>
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="effectivenessChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card__body">
                            <h3>Geographic Coverage</h3>
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="coverageChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card__body">
                            <h3>Satisfaction Trends</h3>
                            <div class="chart-container" style="position: relative; height: 300px;">
                                <canvas id="satisfactionChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Alerts Section - Restricted -->
            <section id="alerts" class="content-section">
                <div class="section-header">
                    <h1>Alerts & Notifications</h1>
                </div>

                <div id="alertsContent" class="alerts-content">
                    <!-- Content will be loaded based on authentication status -->
                </div>
            </section>

            <!-- Reports Section -->
            <section id="reports" class="content-section">
                <div class="section-header">
                    <h1>Reports</h1>
                </div>

                <div class="reports-grid">
                    <div class="card">
                        <div class="card__body">
                            <h3>Public Reports</h3>
                            <div class="public-reports">
                                <div class="report-item">
                                    <div class="report-info">
                                        <h4>Monthly Training Summary</h4>
                                        <p>Public overview of training activities</p>
                                    </div>
                                    <button class="btn btn--secondary btn--sm">Download</button>
                                </div>
                                <div class="report-item">
                                    <div class="report-info">
                                        <h4>Geographic Coverage Report</h4>
                                        <p>Training distribution across states</p>
                                    </div>
                                    <button class="btn btn--secondary btn--sm">Download</button>
                                </div>
                                <div class="report-item">
                                    <div class="report-info">
                                        <h4>Public Statistics</h4>
                                        <p>General platform metrics and trends</p>
                                    </div>
                                    <button class="btn btn--secondary btn--sm">Download</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- User Management Section - Admin Only -->
            <section id="users" class="content-section">
                <div class="access-restricted">
                    <div class="restriction-message">
                        <i class="fas fa-lock"></i>
                        <h3>Admin Access Required</h3>
                        <p>This section is only available to administrators.</p>
                    </div>
                </div>
            </section>

            <!-- Settings Section - Admin Only -->
            <section id="settings" class="content-section">
                <div class="access-restricted">
                    <div class="restriction-message">
                        <i class="fas fa-lock"></i>
                        <h3>Admin Access Required</h3>
                        <p>System settings are only available to administrators.</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Authentication Modals -->
    <!-- Sign In Modal (Registration) -->
    <div id="signInModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create Account</h3>
                <button class="modal-close" id="closeSignInModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="signInForm">
                    <div class="form-group">
                        <label class="form-label" for="signInName">Full Name</label>
                        <input type="text" id="signInName" class="form-control" placeholder="Enter your full name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="signInEmail">Email Address</label>
                        <input type="email" id="signInEmail" class="form-control" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="signInPassword">Password</label>
                        <input type="password" id="signInPassword" class="form-control" placeholder="Create a password" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="signInRole">Role</label>
                        <select id="signInRole" class="form-control" required>
                            <option value="">Select your role</option>
                            <option value="NDMA Admin">NDMA Admin</option>
                            <option value="State Admin">State Admin</option>
                            <option value="District/SDMA">District/SDMA</option>
                            <option value="Trainer">Trainer</option>
                            <option value="Participant">Participant</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="signInState">State</label>
                        <select id="signInState" class="form-control" required>
                            <option value="">Select your state</option>
                        </select>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn--secondary" id="cancelSignIn">Cancel</button>
                        <button type="submit" class="btn btn--primary">Create Account</button>
                    </div>
                    <div class="modal-footer">
                        <p>Already have an account? <a href="#" id="switchToLogIn">Log in here</a></p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Log In Modal -->
    <div id="logInModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Log In</h3>
                <button class="modal-close" id="closeLogInModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="logInForm">
                    <div class="form-group">
                        <label class="form-label" for="logInEmail">Email Address</label>
                        <input type="email" id="logInEmail" class="form-control" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="logInPassword">Password</label>
                        <input type="password" id="logInPassword" class="form-control" placeholder="Enter your password" required>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="rememberMe"> Remember me
                        </label>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn--secondary" id="cancelLogIn">Cancel</button>
                        <button type="submit" class="btn btn--primary">Log In</button>
                    </div>
                    <div class="modal-footer">
                        <p>Don't have an account? <a href="#" id="switchToSignIn">Sign up here</a></p>
                        <p><a href="#" class="forgot-password">Forgot password?</a></p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Training Modal -->
    <div id="trainingModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="trainingModalTitle">Add Training Event</h3>
                <button class="modal-close" id="closeTrainingModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="trainingForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Event Title</label>
                            <input type="text" id="eventTitle" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea id="eventDescription" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Start Date</label>
                            <input type="date" id="startDate" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">End Date</label>
                            <input type="date" id="endDate" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Start Time</label>
                            <input type="time" id="startTime" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">End Time</label>
                            <input type="time" id="endTime" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Trainer</label>
                            <select id="trainer" class="form-control" required>
                                <option value="">Select Trainer</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Capacity</label>
                            <input type="number" id="capacity" class="form-control" min="1" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Location</label>
                            <input type="text" id="location" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Themes</label>
                            <select id="themes" class="form-control" multiple>
                                <!-- Options will be populated by JavaScript -->
                            </select>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn--secondary" id="cancelTraining">Cancel</button>
                        <button type="submit" class="btn btn--primary">Save Training</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="app.js"></script>
</body>
</html>